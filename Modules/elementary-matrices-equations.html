<!DOCTYPE html>
<html>

<head>
  <!-- The following adds MathJax to render LaTeX notation -->
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js"></script>
  <link rel="stylesheet" href="styles.css">
  <script type="text/javascript" src="scripts.js"></script>
</head>

<style>


#blank {
  position: relative;
}


#outer {
  position: absolute;
  height: 300px;
  width: 475px;
  left: 0px;
  top: 90px;
  background-color: white;
  text-align: center}





 
 
 



 #undo {
  position: absolute;
  height: 30px;
  width: 90px;
  left: 217px;
  top: 50px;
  background-color: white;
  text-align: center;}

   
  #input_mat{
    position: absolute;
  height: 200px;
  width: 300px;
  left: 100px;
  top: 90px;
  background-color: white;
  text-align: center;}
 
  #times{
    position: absolute;
  height: 50px;
  width: 30px;
  left: 445px;
  top: 170px;
  background-color: white;
}

#augmented{
    position: absolute;
  height: 220px;
  width: 400px;
  left: 500px;
  top: 90px;
  background-color: white;
  text-align: center;}



  #equations {
  position: absolute;
  height: 235px;
  width: 355px;
  left: 90px;
  top: 350px;
  background-color: rgb(19, 15, 15);
  text-align: center}

  #solution_box {
  position: absolute;
  height: 225px;
  width: 195px;
  left: 600px;
  top: 350px;
  background-color: white;
  border: 9px solid black;
  text-align: center}
  #submit {
  position: absolute;
  height: 30px;
  width: 65px;
  left: 70px;
  top: 180px;
  background-color: white;
  text-align: center}

#solutions1 {
  position: absolute;
  height: 80px;
  width: 95px;
  left: 0px;
  top: 30px;
  background-color: white;
  text-align: center}
  #solutions2 {
  position: absolute;
  height: 80px;
  width: 95px;
  left: 95px;
  top: 30px;
  background-color: white;
  text-align: center}
  #difficulty  {
    position: absolute;
  height: 30px;
  width: 390px;
  left: 505px;
  top: 15px;
  background-color: white;
  text-align: center;}
  #diff_buttons  {
    position: absolute;
  height: 30px;
  width: 390px;
  left: 505px;
  top: 45px;
  font-size: larger;
  background-color: white;
  text-align: center;}


  #score {
  position: absolute;
  height: 220px;
  width: 90px;
  left: 1100px;
  top: 0px;
  background-color: white;
  text-align: center;}




 </style>
 
 
 
 

 
 
 
<body>
  <h2> <center>Module 6: Elementary Matrices </center></h2>
<p>
You are required to solve the set of equations appearing in the black box.  
To help you do this you may use the augmented matrix to the left of the equations. 
In order to make alterations to the augmented matrix, such as row swaps, multiplying
a row by a constant, or adding a multiple of one row to another, enter the values
associated to the corresponding elementary matrix using the input boxes to the 
left.
</p>

<p>
If the set of equations has a single solution you will see one column 
of input boxes in the solutions area. If the set of equations has more than one solution 
you will see two columns of input boxes in the solutions area. In this case you must enter 
two distinct solutions.  Your task is to solve one set of equations of each difficulty level 
from 1 to 9.  After you correctly answer a problem the difficulty will automatically 
increase by 1, but you may also adjust the difficulty with the up/down arrows.
</p>

<div class="popup" onclick="pop()"><u>Level Statistics</u>
  <div class="popuptext" id="myPopup">
    <h3 id="selected" style="text-align:center;">No Level Selected</h3>
    <table >

      <tr>
        <td>Users Who Have Attempted This Level</td>
        <td id="users">0</td>
      </tr>
      <tr>
        <td>Percentage of Users With a Correct Response</td>
        <td id="eventual">0</td>
      </tr>
      <tr>
        <td>Average Number of Attempts per User</td>
        <td id="attempts">0</td>
      </tr>
      <tr>
        <td>Percentage of Attempts that are Correct</td>
        <td id="overall">0</td>
      </tr>

    </table>
    


  </div>
</div>



<div id="blank">
  <div id="score">

  </div>

<div id="undo">
<button  onclick="revert()">Undo</button>
</div>
<div id="diff_buttons">
  <button style="background-color:white" onclick="diff(1)">&#8593</button>
  <button style="background-color:white" onclick="diff(-1)">&#8595</button>
  </div>
  <div id="difficulty">
    Difficulty Level: 1
    </div>


    <div id="input_mat">
    </div>
    <div id="times" >
      <button onclick="multiply()" > <h1>&times</h1> </button>
    </div>
    <div id="augmented">
    </div>

<div id="equations">
</div>





<div id = "solution_box">
Solutions
  <div id="submit">
    <button onclick="check_both()">Submit</button>
  </div>
<div id="solutions1">
</div>
<div id="solutions2">
</div>
</div>


</div>


</div>



<script>







</script>

<script>

var Module_Number="06"

function pop() {
      sql_retrieve(Module_Number)
      var popup = document.getElementById("myPopup");
      popup.classList.toggle("show");
    }

the_time=Date.now()
grades=[]
for (u=0; u<14; u++){
grades.push([0,0])
}


sql_record(Module_Number)


function multiply(){
  record_state()
  B=[[],[],[],[]]

A=get_entries()
X=get_inputs()


for (i=0; i<4; i++){
  for (j=0; j<5; j++){
    sum=[0,1]
    for (k=0; k<4; k++){
      x=rationalize(X[i][k].value)
      a=rationalize(A[k][j].innerHTML)
      b=[x[0]*a[0],x[1]*a[1]]
      sum=[b[0]*sum[1]+b[1]*sum[0],b[1]*sum[1]]
    }
    B[i].push(fractionalize(sum))
  }
}

for (i=0; i<4; i++){
  for (j=0; j<5; j++){
    A[i][j].innerHTML=B[i][j]}}

    for (i=0; i<4; i++){
  for (j=0; j<4; j++){
    if (i==j){
      X[i][j].value=1}
      if (i!=j){
        X[i][j].value=0}
      }
    }


reduce()
write_equations()


}









Colors=["blue","green", "red", "yellow"]




Answered=[0,0,0,0,0,0,0,0,0]
function score(){
  S=document.getElementById("score")
  while(S.firstChild){
  S.removeChild(S.firstChild)}


  var q = document.createElement('h1');
  q.style.fontSize="x-large"
  q.style.textAlign="left"
   q.innerHTML="Score Card"
    S.appendChild(q);

  for (i=0; i<Answered.length; i++){
  qid='q'+i
  var q = document.createElement('div');
  q.style.fontSize="x-large"
  q.style.textAlign="left"
    q.id = qid;
    q.innerHTML = i+1;
    if (Answered[i]==0){
      q.style.color='red'
      Check=q.innerHTML
      Check+=" &#x2610"
      q.innerHTML=Check
    }
    if (Answered[i]>0){
      q.style.color='green'
      Check=q.innerHTML
      Check+=" &#9745"
      q.innerHTML=Check
    }
    S.appendChild(q);
}}




difficulty=1
page=difficulty-1
function diff(k){
  if (difficulty+k<10 && difficulty+k>0){
  difficulty+=k
  page+=k}
  initialize()

  document.getElementById("difficulty").innerText='Difficulty Level: ' + difficulty
}



get_entries()
function get_entries(){
  Entries=[[],[],[],[]]
  for (i=0; i<4; i++){
    for (j=0; j<5; j++){
      Entries[i].push(document.getElementById("A"+i+j))
    }
  }
    return(Entries)}



function get_inputs(){
  Inputs=[[],[],[],[]]
  for (i=0; i<4; i++){
    for (j=0; j<5; j++){
      Inputs[i].push(document.getElementById("X"+i+j))
    }
  }
    return(Inputs)}





    function rationalize(fraction){



if (fraction.includes('.')){
numerator=parseFloat(fraction)
denominator=1

  while (Number.isInteger(numerator)==false & denominator<1000){
    numerator*=10
    denominator*=10
  }
}

else{
  numerator=fraction
denominator=1

    var slash_index=0
      for (var k=0; k<fraction.length; k++){


    
        if ('-0123456789'.includes(fraction[k])==false){
            slash_index=k}
          }

      if (slash_index>0){
        numerator=fraction.substring(0,slash_index)
    denominator=fraction.substring(slash_index+1,fraction.length)}
numerator=parseFloat(numerator)
denominator=parseFloat(denominator)
        if (isNaN(numerator) || isNaN(denominator)){
          denominator=0
        }

        if (denominator<0){
          denominator*=-1
          numerator*=-1
        }}
    return([numerator, denominator])
      }

function fractionalize(A){
  if (A[1]==1 || A[0]==0){
          f=A[0]
        }    
        if (A[1]!=1 && A[0]!=0){
          f=A[0]+'&frasl;'+A[1]
        }
        return(f)
}


function remove_solution_boxes(element_name){

var solution_box = document.getElementById(element_name)
while(solution_box.firstChild){
  solution_box.removeChild(solution_box.firstChild)}
}



function make_solution_boxes(element_name){

variables=['x','y','z','w']
var solution_box = document.getElementById(element_name)
while(solution_box.firstChild){
  solution_box.removeChild(solution_box.firstChild)}

for (i=0; i<4; i++){
  var sol = document.createElement('div');
  sol.style.position='absolute'
  sol.style.width='60px'
  sol.style.height='30px'
  sol.style.fontSize='20px'
  sol.innerHTML=variables[i]+' = '
  sol.style.top=35*i+"px"

  solution_box.appendChild(sol)
  var inp = document.createElement('input');
  inp.style.position='absolute'
  inp.style.left='50px'
  inp.style.width='25px'
  inp.style.height='20px'
  inp.id=variables[i]+element_name
  sol.appendChild(inp)
}

}












function set(complexity){

B0=Math.round(10*(Math.random()+Math.random()))-10
B1=Math.round(10*(Math.random()+Math.random()))-10
B2=Math.round(10*(Math.random()+Math.random()))-10
B3=Math.round(10*(Math.random()+Math.random()))-10
b=[[1,1],[0,1],[0,1],[0,1],[B0,1]]
g=[[0,1],[1,1],[0,1],[0,1],[B1,1]]
r=[[0,1],[0,1],[1,1],[0,1],[B2,1]]
y=[[0,1],[0,1],[0,1],[1,1],[B3,1]]
var Mat_Vals=[b,g,r,y]

//set rank
r=Math.random()
rank=4
if (r<0.3){
  rank-=1
  Mat_Vals[1]=[[0,1],[0,1],[0,1],[0,1],[0,1]]}
if (r<0.1){
  rank-=1
  Mat_Vals[2]=[[0,1],[0,1],[0,1],[0,1],[0,1]]  }        



for (j=0; j<complexity; j++){

  //Switch 2 rows
    if (Math.random()<0.5){
        m=Math.floor(4*Math.random())
        n=Math.floor(4*Math.random())
        var Row1=Mat_Vals[m]
        var Row2=Mat_Vals[n]
        Mat_Vals[m]=Row2
        Mat_Vals[n]=Row1}

  //Multiply row by integer
    if (Math.random()<0.5){
        m=Math.floor(4*Math.random())
        c=Math.round(10*Math.random())-5
        if (c!=0){
            for (k=0; k<5; k++){
                Mat_Vals[m][k][0]*=c}}}

    //Divide row by positive integer
      if (Math.random()<0.3){
        m=Math.floor(4*Math.random())
        c=Math.ceil(4*Math.random())
            for (k=0; k<5; k++){
                Mat_Vals[m][k][1]*=c}}

//Add one row to another
    if (Math.random()<0.9){
        m=Math.floor(4*Math.random())
        n=Math.floor(4*Math.random())
        for (k=0; k<5; k++){
                var t0=Mat_Vals[m][k][0]*Mat_Vals[n][k][1]
                    +Mat_Vals[m][k][1]*Mat_Vals[n][k][0]
                var t1=Mat_Vals[m][k][1]*Mat_Vals[n][k][1]
                Mat_Vals[n][k][0]=t0
                Mat_Vals[n][k][1]=t1
            }}
       
}

//Make Input Matrix

var Input=document.getElementById("input_mat")
while(Input.firstChild){
  Input.removeChild(Input.firstChild)}

for (i=0; i<4; i++){
var row = document.createElement('div');
row.style.position="absolute"
  row.style.height="50px"
  row.style.width="400px"
  row.style.top=60*i+"px"
  Input.appendChild(row);

for (j=0; j<4; j++){
var entry = document.createElement('input');
entry.style.position="absolute"
entry.style.height="45px"
entry.style.width="80px"
entry.style.left=80*j+"px"
entry.style.fontSize="30px"
entry.style.lineHeight="40px"
new_id='X'
new_id+=i
new_id+=j
entry.id=new_id


entry.value=0
if (i==j){
  entry.value=1}


  row.appendChild(entry);
}}

X=[[],[],[],[]]
for (i=0; i<4; i++){
  for (j=0; j<4; j++){
  X[i].push(document.getElementById("X"+i+j))}
}




for (var i=0; i<4; i++){
  for (var j=0; j<4; j++){

X[i][j].addEventListener("keydown", function (e) {



  if (e.code === "Enter") { 
        multiply();
    }


  Active=document.activeElement.id


  var p = parseFloat(Active[1])
  var q = parseFloat(Active[2])
    if (e.keyCode == 37) {
      e.preventDefault()
      var box=document.getElementById("X"+p+(q-1))
      box.setSelectionRange(box.value.length,box.value.length)
      box.focus();
    }
    if (e.keyCode == 38) {
      e.preventDefault()
      var box=document.getElementById("X"+(p-1)+(q))
      box.setSelectionRange(box.value.length,box.value.length)
      box.focus();
    }
    if (e.keyCode == 39) {
      e.preventDefault()
      var box=document.getElementById("X"+p+(q+1))
      box.setSelectionRange(box.value.length,box.value.length)
      box.focus();
    }
    if (e.keyCode == 40) {
      e.preventDefault()
      var box=document.getElementById("X"+(p+1)+(q))
      box.setSelectionRange(box.value.length,box.value.length)
      box.focus();
    }
})

  }}




//Make Augmented Matrix

var Augmented=document.getElementById("augmented")
while(Augmented.firstChild){
  Augmented.removeChild(Augmented.firstChild)}

var Augmented=document.getElementById("augmented")
for (i=0; i<4; i++){
var row = document.createElement('div');
row.style.position="absolute"
  row.style.height="50px"
  row.style.width="400px"
  row.style.top=60*i+"px"
  Augmented.appendChild(row);

for (j=0; j<5; j++){
var entry = document.createElement('div');
entry.style.position="absolute"
entry.style.height="50px"
entry.style.width="80px"
entry.style.left=80*j+"px"
entry.style.backgroundColor=Colors[i]
entry.style.fontSize="30px"
entry.style.lineHeight="50px"
new_id='A'
new_id+=i
new_id+=j
entry.id=new_id


entry.innerHTML=fractionalize(Mat_Vals[i][j])

  row.appendChild(entry);
}}

var line = document.createElement('div');
line.style.position="absolute"
  line.style.height="230px"
  line.style.width="5px"
  line.style.top="0px"
  line.style.left="315px"
  line.style.backgroundColor="black"
  Augmented.appendChild(line);

  }











function write_equations(){

 Entries=get_entries()



    Eq_el=document.getElementById("equations")
    Eq_list=[]
    variables=['x','y','z','w']
    for (i=0; i<4; i++){
      eq=''
      for (j=0; j<4; j++){
        if (Entries[i][j].innerHTML=='1'){
          eq+='+'+variables[j]}
          if (Entries[i][j].innerHTML=='-1'){
          eq+='-'+variables[j]}
          if (Entries[i][j].innerHTML!='-1' && Entries[i][j].innerHTML!='0' && Entries[i][j].innerHTML!='1'){
          if (Entries[i][j].innerHTML[0]=='-'){
            eq+=Entries[i][j].innerHTML+variables[j]}
          if (Entries[i][j].innerHTML[0]!='-'){
            eq+='+'+Entries[i][j].innerHTML+variables[j]}
        }}
        eq+='='+Entries[i][4].innerHTML
        if (eq[0]=='+'){
          eq=' '+eq.substring(1,eq.length)}
        if (eq[0]=='='){
          eq=''}
        

Eq_list.push(eq)
      }
    
  while(Eq_el.firstChild){
  Eq_el.removeChild(Eq_el.firstChild)}
for (i=0; i<4; i++){
  var new_eq = document.createElement('div');
  new_eq.style.position='absolute'
  new_eq.style.width='260px'
  new_eq.style.height='30px'
  new_eq.style.fontSize='20px'
  new_eq.innerHTML=Eq_list[i]
  new_eq.style.top=15+57.5*i+"px"
  new_eq.style.left="50px"
  new_eq.style.color=Colors[i]
  Eq_el.appendChild(new_eq)}


}







function initialize(){
set(difficulty)
reduce()
write_equations()
States=[]
remove_solution_boxes("solutions1")
remove_solution_boxes("solutions2")
make_solution_boxes("solutions1")
if (rank<4){
make_solution_boxes("solutions2")}
score()
}


initialize()
function record_state(){
    Entries=get_entries()
 
var state=[]
for (var i=0; i<Entries.length; i++){
  var rowstate=[]
  for (var j=0; j<Entries[i].length; j++){
    rowstate.push(Entries[i][j].innerHTML)
  }
  state.push(rowstate)
}
    States.push([state[0],state[1],state[2],state[3]])
}





function revert(){
  S=States[States.length-1]

Entries=get_entries()
for (i=0; i<Entries.length; i++){
  for (j=0; j<Entries[i].length; j++){
Entries[i][j].innerHTML=S[i][j]}}


   
  States.splice(States.length-1,1)
}





function swi(i){
  record_state()
  BLUE=document.getElementById("bluetip")
  GREEN=document.getElementById("greentip")
  RED=document.getElementById("redtip")
  YELLOW=document.getElementById("yellowtip")
   Entries=get_entries()
    COL=[BLUE,GREEN,RED,YELLOW]
    First=Entries[i-1]
    Second=Entries[i]
    FirstColor=COL[i-1].style.backgroundColor
    SecondColor=COL[i].style.backgroundColor
    var FirstHTML=[]
    var SecondHTML=[]
    for (var j=0; j<5; j++){
    FirstHTML.push(First[j].innerHTML)
    SecondHTML.push(Second[j].innerHTML)
    }

    for (var j=0; j<5; j++){
    First[j].innerHTML=SecondHTML[j]
    First[j].style.backgroundColor=SecondColor
    Second[j].innerHTML=FirstHTML[j]
    Second[j].style.backgroundColor=FirstColor
    }

    COL[i-1].style.backgroundColor=SecondColor
    COL[i].style.backgroundColor=FirstColor
    write_equations()
    }





    

  



    function reduce(){
    

    Entries=get_entries()
  

   for (i=0; i<Entries.length; i++){
    for (j=0; j<Entries[i].length; j++){
     var n=rationalize(Entries[i][j].innerHTML)
  

var n0=n[0]
var n1=n[1]
lcm=1
for (m=0; m<n1+1; m++){
  if (Number.isInteger(n1/m)==true && Number.isInteger(n0/m)==true){
    lcm=m
  }
}
n0/=lcm
n1/=lcm

if (n1==1){
  Entries[i][j].innerHTML=n0}
  if (n1!=1){
  Entries[i][j].innerHTML=n0+"&frasl;"+n1}
 
    }
  }
}
    


function check_one(e){
 
Entries=get_entries()

var x = (document.getElementById('xsolutions'+e).value)
var y = (document.getElementById('ysolutions'+e).value)
var z = (document.getElementById('zsolutions'+e).value)
var w = (document.getElementById('wsolutions'+e).value)
correct_eqs=-1


if (x!='' || y!='' || z!='' || w!=''){
  correct_eqs=0
  
x=rationalize(x)
y=rationalize(y)
z=rationalize(z)
w=rationalize(w)





vector=[x,y,z,w]
for (i=0; i<4; i++){
  Constant=rationalize(Entries[i][4].innerHTML)
  C=Constant[0]/Constant[1]

  dot_prod=0
  for (j=0; j<4; j++){
    Mij=rationalize(Entries[i][j].innerHTML)
    dot_prod+=Mij[0]/Mij[1]*vector[j][0]/vector[j][1]}

    if (C==dot_prod){
      correct_eqs+=1
    }
  }


}
  return([correct_eqs,[x,y,z,w]])

}




function check_both(){
  solved=0
if (rank==4){
  correct=check_one(1)[0]
  if (correct>=0){
  if (correct==4){
    alert('Good Job')
grades[difficulty-1][0]+=1
    Answered[difficulty-1]+=1
    solved=1
 }

  if (correct<4){
    alert('Only ' + correct + ' of the 4 equations were correct')
    grades[difficulty-1][1]+=1}
  }
if (correct<0){
  alert('Please fill all solution boxes')
}


}

if (rank<4){
  correct1=check_one(1)[0]
  correct2=check_one(2)[0]
  ans1=check_one(1)[1]
  ans2=check_one(2)[1]

if (correct1>=0 && correct2>=0){

  same=1
  for (q=0; q<4; q++){
  if (ans1[q][0]*ans2[q][1]!=ans1[q][1]*ans2[q][0]){
    same=0} }


if (same==0){

  if (correct1==4 && correct2==4){
    alert('Good Job.')
grades[difficulty-1][0]+=1
    Answered[difficulty-1]+=1
    solved=1
}


  if (correct1==4 && correct2<4){
    alert('Your second solution is incorrect.')
    grades[difficulty-1][1]+=1}

  if (correct1<4 && correct2==4){
    alert('Your first solution is incorrect.')
    grades[difficulty-1][1]+=1}

  if (correct1<4 && correct2<4){
    alert('Both solutions are incorrect.')
    grades[difficulty-1][1]+=1}
  }


if (same==1){
  alert('Your answers are the same.')
  grades[difficulty-1][1]+=1

}

}





  if  (correct1<0 || correct2<0){
    alert('Please check that all solution boxes are filled.')
  }
}


if (solved==1){
  diff(1)
}
sql_record(Module_Number)
}







function clear()
{
 if (window.getSelection) {window.getSelection().removeAllRanges();}
 else if (document.selection) {document.selection.empty();}
}



function mobilize(tip) {
    tip.onmousedown = move;  

  function move(e) {
    Y0 = e.clientY;
    x0 = e.clientX;
    y0 = e.clientY;
    document.onmousemove = drag;
    document.onmouseup = close;
  }

function drag(e) {
    dx = e.clientX-x0;
    dy = e.clientY-y0;
    x0 = e.clientX;
    y0 = e.clientY;
    tip.style.left = (tip.offsetLeft + dx) + "px";
    tip.style.top = (tip.offsetTop + dy) + "px";
    clear()
  }

function close(e) {
	document.onmouseup = null;
	document.onmousemove = null;
    document.getElementById("bluetip").style.left="100px";
    document.getElementById("bluetip").style.top="0px";
    document.getElementById("greentip").style.left="100px";
    document.getElementById("greentip").style.top="75px";
    document.getElementById("redtip").style.left="100px";
    document.getElementById("redtip").style.top="150px";
    document.getElementById("yellowtip").style.left="100px";
    document.getElementById("yellowtip").style.top="225px";
    Y1=e.clientY
    ABS=document.getElementById('outer').getBoundingClientRect()
    off=(ABS.top)
    add(Y0-off,Y1-off)
 }
  
  
}



bt=document.getElementById("bluetip")
mobilize(bt)

gt=document.getElementById("greentip")
mobilize(gt)
rt=document.getElementById("redtip")
mobilize(rt)

yt=document.getElementById("yellowtip")
mobilize(yt)






















</script>



</body>
</html>
